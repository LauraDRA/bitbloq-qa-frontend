{"code":"\n/***   Included libraries  ***/\n\n\n/***   Global variables and function definition  ***/\nint led_lamp = 3;int led_on = 4;int boton = 7;int intensidad_luz = A1;float estado = 0;float luz = analogRead(A1);\n\n/***   Setup  ***/\nvoid setup(){pinMode(led_lamp, OUTPUT);pinMode(led_on, OUTPUT);pinMode(boton, INPUT);pinMode(intensidad_luz, INPUT);}\n\n/***   Loop  ***/\nvoid loop(){if(estado == 0){/*\nen el estado 0 ambos leds están apagados\n*/digitalWrite(led_on,LOW);digitalWrite(led_lamp,LOW);if(digitalRead(7) == 1 && analogRead(A1) > 100){/*\nsi se aprieta el botón y la intensidad de luz es alta (he puesto más de 100) pasamos al estado 1. LED STAND BY=ON y LED LAMPARA=OFF\n*/while (digitalRead(7) == 1){delay(100);}estado = 1;}}if(estado == 1){digitalWrite(led_on,HIGH);/*\ndesde el estado 1 pasamos al cero (lámpara apagada) volviendo a pulsar el botón\n*/if(digitalRead(7) == 1){while (digitalRead(7) == 1){delay(100);}estado = 0;}/*\npero si estando en el estado 1 baja la intensidad de luz pasamos al estado 2 (ambos leds encendidos)\n*/else if (analogRead(A1) < 100){estado = 2;}}if(estado == 2){/*\nEl led de la lámpara se enciende, pero al pasar 2 min pasa al estado 3 donde se apaga\n*/digitalWrite(led_lamp,HIGH);delay(120000);estado = 3;}if(estado == 3){/*\ndespués de los 2 min se llega al estado 3 donde el led de la lámpara se apaga\n*/digitalWrite(led_lamp,LOW);if(analogRead(A1) > 100){/*\npero si estando apagado volviera a aumentar la intensidad de luz (se ha hecho de día) se vuelve al estado 1 (esperando a que vuelva a hacerse de noche para que el led de la lámpara se encienda otra vez durante 2 min)\n*/estado = 1;}/*\na no ser que pulsásemos el botón con lo que la lámpara se apagaría (estado 0)\n*/if(digitalRead(7) == 1){while (digitalRead(7) == 1){delay(100);}estado = 0;}}}","description":"He supuesto para el sensor de luz>100 amanecer y para <100 anochecer. Estos valores podrían cambiarse. \nLa lámpara se pone en funcionamiento (led de satand by) al pulsar el botón. Si se vuelve a pulsar se apaga. Cuando está encendida, en caso de hacerse de noche se enciende el led de la lámpara y se apaga a los dos minutos. Es necesario que vuelva a amanecer (luz>100) para que al oscurecer (luz<100) vuelva a iluminarse durante 2 min.","name":"lampara_fernando_mencia","corbelId":"55acae7ae4b00f538d041f75:ba344994-c5d6-448f-a033-870e359dd566","image":"default","userTags":[],"hardwareTags":["bq ZUM","led","button","ldrs"],"software":{"loop":{"content":[[]],"childs":[{"content":[[{"bloqInputId":"ARG1","value":{"content":[[{"value":"estado","id":"VAR","alias":"dynamicDropdown"}]],"name":"selectVariable","enable":true},"alias":"bloqInput"},{"value":"==","id":"OPERATOR","alias":"staticDropdown"},{"bloqInputId":"ARG2","value":{"content":[[{"value":"0","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"}]],"childs":[{"content":[[{"value":"en el estado 0 ambos leds están apagados","id":"COMMENT","alias":"multilineCodeInput"}]],"name":"comment","enable":true},{"content":[[{"value":"LOW","id":"STATE","alias":"staticDropdown"},{"value":"led_on","id":"LED","alias":"dynamicDropdown"}]],"name":"led","enable":true},{"content":[[{"value":"LOW","id":"STATE","alias":"staticDropdown"},{"value":"led_lamp","id":"LED","alias":"dynamicDropdown"}]],"name":"led","enable":true},{"content":[[{"bloqInputId":"CONDITION","value":{"content":[[{"bloqInputId":"ARG1","value":{"content":[[{"bloqInputId":"ARG1","value":{"content":[[{"value":"boton","id":"SENSOR","alias":"dynamicDropdown"}]],"name":"readSensor","enable":true},"alias":"bloqInput"},{"value":"==","id":"OPERATOR","alias":"staticDropdown"},{"bloqInputId":"ARG2","value":{"content":[[{"value":"1","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"}]],"name":"equalityOperations","enable":true},"alias":"bloqInput"},{"value":"&&","id":"OPERATOR","alias":"staticDropdown"},{"bloqInputId":"ARG2","value":{"content":[[{"bloqInputId":"ARG1","value":{"content":[[{"value":"intensidad_luz","id":"SENSOR","alias":"dynamicDropdown"}]],"name":"readSensor","enable":true},"alias":"bloqInput"},{"value":">","id":"OPERATOR","alias":"staticDropdown"},{"bloqInputId":"ARG2","value":{"content":[[{"value":"100","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"}]],"name":"equalityOperations","enable":true},"alias":"bloqInput"}]],"name":"logicOperations","enable":true},"alias":"bloqInput"}]],"childs":[{"content":[[{"value":"si se aprieta el botón y la intensidad de luz es alta (he puesto más de 100) pasamos al estado 1. LED STAND BY=ON y LED LAMPARA=OFF","id":"COMMENT","alias":"multilineCodeInput"}]],"name":"comment","enable":true},{"content":[[{"bloqInputId":"ARG1","value":{"content":[[{"value":"boton","id":"SENSOR","alias":"dynamicDropdown"}]],"name":"readSensor","enable":true},"alias":"bloqInput"},{"value":"==","id":"OPERATOR","alias":"staticDropdown"},{"bloqInputId":"ARG2","value":{"content":[[{"value":"1","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"}]],"childs":[{"content":[[{"value":"100","id":"TIME","alias":"numberInput"}]],"name":"wait","enable":true}],"name":"while","enable":true},{"content":[[{"value":"estado","id":"NAME","alias":"dynamicDropdown"},{"bloqInputId":"VALUE","value":{"content":[[{"value":"1","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"}]],"name":"setVariable","enable":true}],"name":"ifAdvanced","enable":true}],"name":"if","enable":true},{"content":[[{"bloqInputId":"ARG1","value":{"content":[[{"value":"estado","id":"VAR","alias":"dynamicDropdown"}]],"name":"selectVariable","enable":true},"alias":"bloqInput"},{"value":"==","id":"OPERATOR","alias":"staticDropdown"},{"bloqInputId":"ARG2","value":{"content":[[{"value":"1","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"}]],"childs":[{"content":[[{"value":"HIGH","id":"STATE","alias":"staticDropdown"},{"value":"led_on","id":"LED","alias":"dynamicDropdown"}]],"name":"led","enable":true},{"content":[[{"value":"desde el estado 1 pasamos al cero (lámpara apagada) volviendo a pulsar el botón","id":"COMMENT","alias":"multilineCodeInput"}]],"name":"comment","enable":true},{"content":[[{"bloqInputId":"ARG1","value":{"content":[[{"value":"boton","id":"SENSOR","alias":"dynamicDropdown"}]],"name":"readSensor","enable":true},"alias":"bloqInput"},{"value":"==","id":"OPERATOR","alias":"staticDropdown"},{"bloqInputId":"ARG2","value":{"content":[[{"value":"1","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"}]],"childs":[{"content":[[{"bloqInputId":"ARG1","value":{"content":[[{"value":"boton","id":"SENSOR","alias":"dynamicDropdown"}]],"name":"readSensor","enable":true},"alias":"bloqInput"},{"value":"==","id":"OPERATOR","alias":"staticDropdown"},{"bloqInputId":"ARG2","value":{"content":[[{"value":"1","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"}]],"childs":[{"content":[[{"value":"100","id":"TIME","alias":"numberInput"}]],"name":"wait","enable":true}],"name":"while","enable":true},{"content":[[{"value":"estado","id":"NAME","alias":"dynamicDropdown"},{"bloqInputId":"VALUE","value":{"content":[[{"value":"0","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"}]],"name":"setVariable","enable":true}],"name":"if","enable":true},{"content":[[{"value":"pero si estando en el estado 1 baja la intensidad de luz pasamos al estado 2 (ambos leds encendidos)","id":"COMMENT","alias":"multilineCodeInput"}]],"name":"comment","enable":true},{"content":[[{"bloqInputId":"ARG1","value":{"content":[[{"value":"intensidad_luz","id":"SENSOR","alias":"dynamicDropdown"}]],"name":"readSensor","enable":true},"alias":"bloqInput"},{"value":"<","id":"OPERATOR","alias":"staticDropdown"},{"bloqInputId":"ARG2","value":{"content":[[{"value":"100","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"}]],"childs":[{"content":[[{"value":"estado","id":"NAME","alias":"dynamicDropdown"},{"bloqInputId":"VALUE","value":{"content":[[{"value":"2","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"}]],"name":"setVariable","enable":true}],"name":"elseif","enable":true}],"name":"if","enable":true},{"content":[[{"bloqInputId":"ARG1","value":{"content":[[{"value":"estado","id":"VAR","alias":"dynamicDropdown"}]],"name":"selectVariable","enable":true},"alias":"bloqInput"},{"value":"==","id":"OPERATOR","alias":"staticDropdown"},{"bloqInputId":"ARG2","value":{"content":[[{"value":"2","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"}]],"childs":[{"content":[[{"value":"El led de la lámpara se enciende, pero al pasar 2 min pasa al estado 3 donde se apaga","id":"COMMENT","alias":"multilineCodeInput"}]],"name":"comment","enable":true},{"content":[[{"value":"HIGH","id":"STATE","alias":"staticDropdown"},{"value":"led_lamp","id":"LED","alias":"dynamicDropdown"}]],"name":"led","enable":true},{"content":[[{"value":"120000","id":"TIME","alias":"numberInput"}]],"name":"wait","enable":true},{"content":[[{"value":"estado","id":"NAME","alias":"dynamicDropdown"},{"bloqInputId":"VALUE","value":{"content":[[{"value":"3","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"}]],"name":"setVariable","enable":true}],"name":"if","enable":true},{"content":[[{"bloqInputId":"ARG1","value":{"content":[[{"value":"estado","id":"VAR","alias":"dynamicDropdown"}]],"name":"selectVariable","enable":true},"alias":"bloqInput"},{"value":"==","id":"OPERATOR","alias":"staticDropdown"},{"bloqInputId":"ARG2","value":{"content":[[{"value":"3","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"}]],"childs":[{"content":[[{"value":"después de los 2 min se llega al estado 3 donde el led de la lámpara se apaga","id":"COMMENT","alias":"multilineCodeInput"}]],"name":"comment","enable":true},{"content":[[{"value":"LOW","id":"STATE","alias":"staticDropdown"},{"value":"led_lamp","id":"LED","alias":"dynamicDropdown"}]],"name":"led","enable":true},{"content":[[{"bloqInputId":"ARG1","value":{"content":[[{"value":"intensidad_luz","id":"SENSOR","alias":"dynamicDropdown"}]],"name":"readSensor","enable":true},"alias":"bloqInput"},{"value":">","id":"OPERATOR","alias":"staticDropdown"},{"bloqInputId":"ARG2","value":{"content":[[{"value":"100","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"}]],"childs":[{"content":[[{"value":"pero si estando apagado volviera a aumentar la intensidad de luz (se ha hecho de día) se vuelve al estado 1 (esperando a que vuelva a hacerse de noche para que el led de la lámpara se encienda otra vez durante 2 min)","id":"COMMENT","alias":"multilineCodeInput"}]],"name":"comment","enable":true},{"content":[[{"value":"estado","id":"NAME","alias":"dynamicDropdown"},{"bloqInputId":"VALUE","value":{"content":[[{"value":"1","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"}]],"name":"setVariable","enable":true}],"name":"if","enable":true},{"content":[[{"value":"a no ser que pulsásemos el botón con lo que la lámpara se apagaría (estado 0)","id":"COMMENT","alias":"multilineCodeInput"}]],"name":"comment","enable":true},{"content":[[{"bloqInputId":"ARG1","value":{"content":[[{"value":"boton","id":"SENSOR","alias":"dynamicDropdown"}]],"name":"readSensor","enable":true},"alias":"bloqInput"},{"value":"==","id":"OPERATOR","alias":"staticDropdown"},{"bloqInputId":"ARG2","value":{"content":[[{"value":"1","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"}]],"childs":[{"content":[[{"bloqInputId":"ARG1","value":{"content":[[{"value":"boton","id":"SENSOR","alias":"dynamicDropdown"}]],"name":"readSensor","enable":true},"alias":"bloqInput"},{"value":"==","id":"OPERATOR","alias":"staticDropdown"},{"bloqInputId":"ARG2","value":{"content":[[{"value":"1","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"}]],"childs":[{"content":[[{"value":"100","id":"TIME","alias":"numberInput"}]],"name":"wait","enable":true}],"name":"while","enable":true},{"content":[[{"value":"estado","id":"NAME","alias":"dynamicDropdown"},{"bloqInputId":"VALUE","value":{"content":[[{"value":"0","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"}]],"name":"setVariable","enable":true}],"name":"if","enable":true}],"name":"if","enable":true}],"name":"loopBloq","enable":true},"setup":{"content":[[]],"childs":[],"name":"setupBloq","enable":true},"vars":{"content":[[]],"childs":[{"content":[[{"value":"estado","id":"NAME","alias":"varInput"},{"bloqInputId":"VALUE","value":{"content":[[{"value":"0","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"}]],"name":"declareVariable","enable":true},{"content":[[{"value":"luz","id":"NAME","alias":"varInput"},{"bloqInputId":"VALUE","value":{"content":[[{"value":"intensidad_luz","id":"SENSOR","alias":"dynamicDropdown"}]],"name":"readSensor","enable":true},"alias":"bloqInput"}]],"name":"declareVariable","enable":true}],"name":"varsBloq","enable":true}},"hardware":{"board":"bq ZUM","connections":[{"pinSourceUid":"cb09ff1b-9c33-41ee-b839-7b40ce378ea9","pinTargetUid":"6be0dd9d-2e52-4b7d-9dfc-c9edad53bd10"},{"pinSourceUid":"99493f2b-4325-41f8-ade7-ddf8f130ca44","pinTargetUid":"6be0dd9d-2e52-4b7d-9dfc-c9edad53bd09"},{"pinSourceUid":"5d9ceb07-baac-4c54-b80e-f2fab85e0aae","pinTargetUid":"6be0dd9d-2e52-4b7d-9dfc-c9edad53bd06"},{"pinSourceUid":"10dd8758-45b6-475e-a245-f446284b26a7","pinTargetUid":"6be0dd9d-2e52-4b7d-9dfc-c9edad53ba04"}],"components":[{"height":83,"category":"leds","id":"led","pins":{"digital":["s"]},"name":"led_lamp","coordinates":{"y":21.364452423698385,"x":84.16206261510129},"width":55,"icon":"LED","pin":{"s":"3"},"endpoints":{"s":{"type":"digital","uid":"cb09ff1b-9c33-41ee-b839-7b40ce378ea9"}},"uid":"f48b6ff5-598a-44a6-b75d-afc6c2c15daa","connected":true},{"height":83,"category":"leds","id":"led","pins":{"digital":["s"]},"name":"led_on","coordinates":{"y":5.385996409335727,"x":56.813996316758754},"width":55,"icon":"LED","pin":{"s":"4"},"endpoints":{"s":{"type":"digital","uid":"99493f2b-4325-41f8-ade7-ddf8f130ca44"}},"uid":"ca4302b5-eb62-4fb8-ae06-1f6da8166bd6","connected":true},{"height":73,"category":"sensors","id":"button","name":"boton","width":90,"pin":{"s":"7"},"uid":"950924e5-7625-410a-b331-52d40efc3fb7","connected":true,"type":"digital","pins":{"digital":["s"]},"coordinates":{"y":11.8491921005386,"x":26.151012891344383},"icon":"button","endpoints":{"s":{"type":"digital","uid":"5d9ceb07-baac-4c54-b80e-f2fab85e0aae"}}},{"height":65,"category":"sensors","id":"ldrs","name":"intensidad_luz","width":90,"pin":{"s":"A1"},"uid":"bb32bb44-3d6d-4338-b73f-db9a0b403b82","connected":true,"type":"analog","pins":{"analog":["s"]},"coordinates":{"y":78.63554757630162,"x":63.62799263351749},"icon":"LDR","endpoints":{"s":{"type":"analog","uid":"10dd8758-45b6-475e-a245-f446284b26a7"}}}]},"defaultTheme":"infotab_option_colorTheme","timesDownload":0,"timesAdded":0,"timesViewed":0}