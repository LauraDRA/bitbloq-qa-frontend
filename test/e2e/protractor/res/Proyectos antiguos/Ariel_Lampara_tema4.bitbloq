{"code":"\n/***   Included libraries  ***/\n\n\n/***   Global variables and function definition  ***/\nint led_on_off = 3;int led_bombilla = 4;int sensor_de_luz_0 = A1;int bt_interruptor = 7;/*\nVariable que controla el estado de la lámpara si está en on o en off.\n*/float Estado_interruptor = 0;/*\nDeclaro la variable \"DiaoNoche\" para apagarla cuando pase 2 minutos y no vuelva a funcionar hasta que se vuelva a hacer de día y el interruptor este en on.\n*/float DiaONoche = 0;/*\nEn la variable \"EsperaSegundos\" le damos el valor en segundo que queremos que espere la lámpara para apagarse.\n*/float EsperaSegundos = 120;\n\n/***   Setup  ***/\nvoid setup(){pinMode(led_on_off, OUTPUT);pinMode(led_bombilla, OUTPUT);pinMode(sensor_de_luz_0, INPUT);pinMode(bt_interruptor, INPUT);}\n\n/***   Loop  ***/\nvoid loop(){/*\nCon este if controlo el estado del botón (on/off)\n*/if(digitalRead(7) == 1){while (digitalRead(7) == 1){delay(100);}if(Estado_interruptor < 1){Estado_interruptor = Estado_interruptor + 1;}else {Estado_interruptor = 0;}}switch (int(Estado_interruptor)) {case 0:{digitalWrite(led_on_off,LOW);break;}case 1:{digitalWrite(led_on_off,HIGH);/*\nCompruebo el valor del sensor de luz y la variable  \"DiaoNoche\" par ver si se cumple las dos condiciones y encender la lámpara. \n*/if(analogRead(A1) < 50 && DiaONoche == 0){/*\nLe asigno el valor 1 a la variable \"DiaoNoche\" para que pasado los dos minutos de espera no vuelva a encender la lámpara.\n*/DiaONoche = 1;digitalWrite(led_bombilla,HIGH);/*\nmultiplicamos el valor de la variable \"EsperaSegundos\" por \"1000ns\" para obtener los segundos de espera.\n*/delay(EsperaSegundos * 1000);digitalWrite(led_bombilla,LOW);}/*\nCon este \"if\" hago que cuando se haga de día vuelva la variable \"Diaonoche\" a su estado original y al volver a ser de noche encienda nuevamente la lámpara siempre que el interruptor este en \"on\"\n*/if(analogRead(A1) > 50){DiaONoche = 0;}break;}}/*\nAriel Martin Marrero\n*/}","description":"","name":"Ariel_Lampara_tema4","corbelId":"55acae7ae4b00f538d041f75:595cdb4d-0612-4362-bdc0-12d08bc8649e","image":"default","userTags":[],"hardwareTags":["bq ZUM","led","ldrs","button"],"software":{"loop":{"content":[[]],"childs":[{"content":[[{"value":"Con este if controlo el estado del botón (on/off)","id":"COMMENT","alias":"multilineCodeInput"}]],"name":"comment","enable":true},{"content":[[{"bloqInputId":"ARG1","value":{"content":[[{"value":"bt_interruptor","id":"SENSOR","alias":"dynamicDropdown"}]],"name":"readSensor","enable":true},"alias":"bloqInput"},{"value":"==","id":"OPERATOR","alias":"staticDropdown"},{"bloqInputId":"ARG2","value":{"content":[[{"value":"1","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"}]],"childs":[{"content":[[{"bloqInputId":"ARG1","value":{"content":[[{"value":"bt_interruptor","id":"SENSOR","alias":"dynamicDropdown"}]],"name":"readSensor","enable":true},"alias":"bloqInput"},{"value":"==","id":"OPERATOR","alias":"staticDropdown"},{"bloqInputId":"ARG2","value":{"content":[[{"value":"1","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"}]],"childs":[{"content":[[{"value":"100","id":"TIME","alias":"numberInput"}]],"name":"wait","enable":true}],"name":"while","enable":true},{"content":[[{"bloqInputId":"ARG1","value":{"content":[[{"value":"Estado_interruptor","id":"VAR","alias":"dynamicDropdown"}]],"name":"selectVariable","enable":true},"alias":"bloqInput"},{"value":"<","id":"OPERATOR","alias":"staticDropdown"},{"bloqInputId":"ARG2","value":{"content":[[{"value":"1","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"}]],"childs":[{"content":[[{"value":"Estado_interruptor","id":"NAME","alias":"dynamicDropdown"},{"bloqInputId":"VALUE","value":{"content":[[{"bloqInputId":"ARG1","value":{"content":[[{"value":"Estado_interruptor","id":"VAR","alias":"dynamicDropdown"}]],"name":"selectVariable","enable":true},"alias":"bloqInput"},{"value":"+","id":"OPERATOR","alias":"staticDropdown"},{"bloqInputId":"ARG2","value":{"content":[[{"value":"1","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"}]],"name":"basicOperations","enable":true},"alias":"bloqInput"}]],"name":"setVariable","enable":true}],"name":"if","enable":true},{"content":[[]],"childs":[{"content":[[{"value":"Estado_interruptor","id":"NAME","alias":"dynamicDropdown"},{"bloqInputId":"VALUE","value":{"content":[[{"value":"0","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"}]],"name":"setVariable","enable":true}],"name":"else","enable":true}],"name":"if","enable":true},{"content":[[{"value":"Estado_interruptor","id":"VAR","alias":"dynamicDropdown"}]],"childs":[{"content":[[{"value":"0","id":"VAR","alias":"numberInput"}]],"childs":[{"content":[[{"value":"LOW","id":"STATE","alias":"staticDropdown"},{"value":"led_on_off","id":"LED","alias":"dynamicDropdown"}]],"name":"led","enable":true}],"name":"case","enable":true},{"content":[[{"value":"1","id":"VAR","alias":"numberInput"}]],"childs":[{"content":[[{"value":"HIGH","id":"STATE","alias":"staticDropdown"},{"value":"led_on_off","id":"LED","alias":"dynamicDropdown"}]],"name":"led","enable":true},{"content":[[{"value":"Compruebo el valor del sensor de luz y la variable  \"DiaoNoche\" par ver si se cumple las dos condiciones y encender la lámpara. ","id":"COMMENT","alias":"multilineCodeInput"}]],"name":"comment","enable":true},{"content":[[{"bloqInputId":"ARG1","value":{"content":[[{"value":"sensor_de_luz_0","id":"SENSOR","alias":"dynamicDropdown"}]],"name":"readSensor","enable":true},"alias":"bloqInput"},{"value":"<","id":"OPERATOR","alias":"staticDropdown"},{"bloqInputId":"ARG2","value":{"content":[[{"bloqInputId":"ARG1","value":{"content":[[{"value":"50","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"},{"value":"&&","id":"OPERATOR","alias":"staticDropdown"},{"bloqInputId":"ARG2","value":{"content":[[{"bloqInputId":"ARG1","value":{"content":[[{"value":"DiaONoche","id":"VAR","alias":"dynamicDropdown"}]],"name":"selectVariable","enable":true},"alias":"bloqInput"},{"value":"==","id":"OPERATOR","alias":"staticDropdown"},{"bloqInputId":"ARG2","value":{"content":[[{"value":"0","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"}]],"name":"equalityOperations","enable":true},"alias":"bloqInput"}]],"name":"logicOperations","enable":true},"alias":"bloqInput"}]],"childs":[{"content":[[{"value":"Le asigno el valor 1 a la variable \"DiaoNoche\" para que pasado los dos minutos de espera no vuelva a encender la lámpara.","id":"COMMENT","alias":"multilineCodeInput"}]],"name":"comment","enable":true},{"content":[[{"value":"DiaONoche","id":"NAME","alias":"dynamicDropdown"},{"bloqInputId":"VALUE","value":{"content":[[{"value":"1","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"}]],"name":"setVariable","enable":true},{"content":[[{"value":"HIGH","id":"STATE","alias":"staticDropdown"},{"value":"led_bombilla","id":"LED","alias":"dynamicDropdown"}]],"name":"led","enable":true},{"content":[[{"value":"multiplicamos el valor de la variable \"EsperaSegundos\" por \"1000ns\" para obtener los segundos de espera.","id":"COMMENT","alias":"multilineCodeInput"}]],"name":"comment","enable":true},{"content":[[{"bloqInputId":"TIME","value":{"content":[[{"bloqInputId":"ARG1","value":{"content":[[{"value":"EsperaSegundos","id":"VAR","alias":"dynamicDropdown"}]],"name":"selectVariable","enable":true},"alias":"bloqInput"},{"value":"*","id":"OPERATOR","alias":"staticDropdown"},{"bloqInputId":"ARG2","value":{"content":[[{"value":"1000","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"}]],"name":"basicOperations","enable":true},"alias":"bloqInput"}]],"name":"waitAdvanced","enable":true},{"content":[[{"value":"LOW","id":"STATE","alias":"staticDropdown"},{"value":"led_bombilla","id":"LED","alias":"dynamicDropdown"}]],"name":"led","enable":true}],"name":"if","enable":true},{"content":[[{"value":"Con este \"if\" hago que cuando se haga de día vuelva la variable \"Diaonoche\" a su estado original y al volver a ser de noche encienda nuevamente la lámpara siempre que el interruptor este en \"on\"","id":"COMMENT","alias":"multilineCodeInput"}]],"name":"comment","enable":true},{"content":[[{"bloqInputId":"ARG1","value":{"content":[[{"value":"sensor_de_luz_0","id":"SENSOR","alias":"dynamicDropdown"}]],"name":"readSensor","enable":true},"alias":"bloqInput"},{"value":">","id":"OPERATOR","alias":"staticDropdown"},{"bloqInputId":"ARG2","value":{"content":[[{"value":"50","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"}]],"childs":[{"content":[[{"value":"DiaONoche","id":"NAME","alias":"dynamicDropdown"},{"bloqInputId":"VALUE","value":{"content":[[{"value":"0","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"}]],"name":"setVariable","enable":true}],"name":"if","enable":true}],"name":"case","enable":true}],"name":"switch","enable":true},{"content":[[{"value":"Ariel Martin Marrero","id":"COMMENT","alias":"multilineCodeInput"}]],"name":"comment","enable":true}],"name":"loopBloq","enable":true},"setup":{"content":[[]],"childs":[],"name":"setupBloq","enable":true},"vars":{"content":[[]],"childs":[{"content":[[{"value":"Variable que controla el estado de la lámpara si está en on o en off.","id":"COMMENT","alias":"multilineCodeInput"}]],"name":"comment","enable":true},{"content":[[{"value":"Estado_interruptor","id":"NAME","alias":"varInput"},{"bloqInputId":"VALUE","value":{"content":[[{"value":"0","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"}]],"name":"declareVariable","enable":true},{"content":[[{"value":"Declaro la variable \"DiaoNoche\" para apagarla cuando pase 2 minutos y no vuelva a funcionar hasta que se vuelva a hacer de día y el interruptor este en on.","id":"COMMENT","alias":"multilineCodeInput"}]],"name":"comment","enable":true},{"content":[[{"value":"DiaONoche","id":"NAME","alias":"varInput"},{"bloqInputId":"VALUE","value":{"content":[[{"value":"0","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"}]],"name":"declareVariable","enable":true},{"content":[[{"value":"En la variable \"EsperaSegundos\" le damos el valor en segundo que queremos que espere la lámpara para apagarse.","id":"COMMENT","alias":"multilineCodeInput"}]],"name":"comment","enable":true},{"content":[[{"value":"EsperaSegundos","id":"NAME","alias":"varInput"},{"bloqInputId":"VALUE","value":{"content":[[{"value":"120","id":"VALUE","alias":"numberInput"}]],"name":"number","enable":true},"alias":"bloqInput"}]],"name":"declareVariable","enable":true}],"name":"varsBloq","enable":true}},"hardware":{"board":"bq ZUM","connections":[{"pinSourceUid":"62abb630-36b0-4525-a3d7-8ae939db1e2a","pinTargetUid":"6be0dd9d-2e52-4b7d-9dfc-c9edad53bd10"},{"pinSourceUid":"b53c7032-c734-4137-b118-9566cb854dec","pinTargetUid":"6be0dd9d-2e52-4b7d-9dfc-c9edad53bd09"},{"pinSourceUid":"df4488a4-eb61-4715-a9cd-089b2d095d09","pinTargetUid":"6be0dd9d-2e52-4b7d-9dfc-c9edad53ba04"},{"pinSourceUid":"35906082-9a08-4e04-9d57-b747569dd337","pinTargetUid":"6be0dd9d-2e52-4b7d-9dfc-c9edad53bd06"}],"components":[{"height":83,"category":"leds","id":"led","pins":{"digital":["s"]},"name":"led_on_off","coordinates":{"y":14.018691588785046,"x":63.353658536585364},"width":55,"icon":"LED","pin":{"s":"3"},"endpoints":{"s":{"type":"digital","uid":"62abb630-36b0-4525-a3d7-8ae939db1e2a"}},"uid":"ce62ebb6-dd91-47a2-88c9-8146bda03b95","connected":true},{"height":83,"category":"leds","id":"led","pins":{"digital":["s"]},"name":"led_bombilla","coordinates":{"y":12.950600801068092,"x":28.597560975609753},"width":55,"icon":"LED","pin":{"s":"4"},"endpoints":{"s":{"type":"digital","uid":"b53c7032-c734-4137-b118-9566cb854dec"}},"uid":"e1a43656-8327-4e06-b679-c55a4b95323a","connected":true},{"height":65,"category":"sensors","id":"ldrs","name":"sensor_de_luz_0","width":90,"pin":{"s":"A1"},"uid":"58b0bc95-11cc-416c-a241-3e18bddcbf27","connected":true,"type":"analog","pins":{"analog":["s"]},"coordinates":{"y":73.16421895861149,"x":62.31707317073171},"icon":"LDR","endpoints":{"s":{"type":"analog","uid":"df4488a4-eb61-4715-a9cd-089b2d095d09"}}},{"height":73,"category":"sensors","id":"button","name":"bt_interruptor","width":90,"pin":{"s":"7"},"uid":"9132653e-2376-45ee-be6d-da6f43dd0321","connected":true,"type":"digital","pins":{"digital":["s"]},"coordinates":{"y":20.29372496662216,"x":23.414634146341466},"icon":"button","endpoints":{"s":{"type":"digital","uid":"35906082-9a08-4e04-9d57-b747569dd337"}}}]},"defaultTheme":"infotab_option_colorTheme","timesDownload":0,"timesAdded":0,"timesViewed":0}