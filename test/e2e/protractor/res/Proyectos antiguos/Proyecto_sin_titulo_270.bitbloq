{"code":"/***   Included libraries  ***/\n#include <Servo.h>\n#include <SoftwareSerial.h> \n#include <BitbloqSoftwareSerial.h>\n\n\n/***   Global variables and function definition  ***/\n\nServo miServo; //variable servo\nconst int pinPotenciometro = A5; // pin del sensor analogico, con un potenciometro\nconst int pinIR = 2; // pin del sensor digital, con un sensor IR\nbqSoftwareSerial puerto_serie_0(0, 1, 9600); //variable puerto serie\nfloat valorPotenciometro = 0; //declaramos una variable para leer el valor del potenciómetro\nfloat valorAngulo = 0; //declaramos una variable para dar valor al angulo del servo a partir del valorPotenciometro\n\n\nvolatile int numeroNegros = 0; //variable dentro de la interrupción \n//función dentro de la interrupción que mide el número de negros que pasan mediante un contador\nvoid medirAngulo() {\n    numeroNegros++;\n}\n\nunsigned long previoMillis = 0; //guarda el tiempo previo a la medición del intervalo\nconst int intervalo = 10000; //tomamos un intervalo de 10 s\nconst float arcoNegroBlanco = 3.141592 / 12; //estos son los radiames correspondientes a cada par negro-blanco\nfloat velocidadMedia = 0; //se usará para calcular la velocidad media de esos 10 segundos\n\n/***   Setup  ***/\nvoid setup() {\n\n    miServo.attach(13); //asocioamos el servo al pin 13\n    miServo.write(90); //paramos el servo\n\n    pinMode(pinPotenciometro, INPUT); //declaramos el pin del potenciómetro como entrada\n\n    pinMode(pinIR, INPUT); //declaramos el pin del sensor IR como entrada\n\n    Serial.begin(9600); //inicializa la comunicación puerto serie\n\n    attachInterrupt(0, medirAngulo, FALLING); //definimos la interrupcion 0 a través del IR al pasar de blanco a negro\n}\n\n/***   Loop  ***/\nvoid loop() {\n\n    /***  definimos la velocidad del disco mediante el giro del potenciómetro  ***/\n\n    valorPotenciometro = analogRead(pinPotenciometro);\n    valorAngulo = map(valorPotenciometro, 0, 1023, 90, 179); //giramos únicamente en una dirección\n    miServo.write(valorAngulo);\n    delay(10);\n\n    /***   medimos el tiempo del intervalo y calculamos la velocidad media    ***/\n\n    unsigned long actualMillis = millis(); //creamos la variable que guardará el tiempo de funcionamiento\n    //hasta que no pase un tiempo igual  superior a intervalo no hace nada\n    if (actualMillis - previoMillis >= intervalo) { //al transcurrir ese tiempo \n\n        previoMillis = actualMillis; //guardamos ese tiempo como inicial\n        velocidadMedia = (numeroNegros * arcoNegroBlanco / intervalo); // calculamos la velocidad media a través del contador de interrupciones, valor del arco e intervalo\n        Serial.print(\"Velocidad Media en rad/s =\"); //lo mostramos en pantalla\n        Serial.println(velocidadMedia);\n\n\n    }\n}","codeProject":true,"description":"","videoUrl":"","name":"Proyecto sin título","corbelId":"55acae7ae4b00f538d041f75:bcc8c418-9ddc-4612-ae39-67e7c3d9d459","image":"default","userTags":[],"hardwareTags":["bq ZUM"],"software":{"loop":{"enable":true,"name":"loopBloq","childs":[],"content":[[]]},"setup":{"enable":true,"name":"setupBloq","childs":[],"content":[[]]},"vars":{"enable":true,"name":"varsBloq","childs":[],"content":[[]]}},"hardware":{"board":"bq ZUM","connections":[{"pinTargetUid":"6be0dd9d-2e52-4b7d-9dfc-c9edad53bd02","pinSourceUid":"34befbb7-4efa-4da8-a93d-09f987d8503f"}],"components":[{"endpoints":{"s":{"uid":"34befbb7-4efa-4da8-a93d-09f987d8503f","type":"digital"}},"oscillator":"false","coordinates":{"x":64,"y":19.2090395480226},"pins":{"digital":["s"]},"dragtype":"components","connected":true,"uid":"3253de38-c1b9-4907-8485-75140e3aec55","pin":{"s":"11"},"width":125,"name":"servo_0","id":"servo","category":"servos","height":106}]},"defaultTheme":"infotab_option_colorTheme","timesDownload":0,"timesAdded":0,"timesViewed":0}